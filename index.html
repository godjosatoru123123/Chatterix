<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>MarkNet</title>
  <style>
    body {
      background: #111;
      color: white;
      font-family: sans-serif;
      padding: 20px;
    }
    input, button {
      background: #222;
      color: white;
      border: 1px solid #555;
      padding: 5px;
      margin: 5px 0;
    }
    .hidden { display: none; }
    .chat { background: #000; padding: 10px; height: 200px; overflow-y: auto; border: 1px solid #333; }
    .user-list img {
      width: 32px; height: 32px;
      border-radius: 50%;
      vertical-align: middle;
      margin-right: 10px;
    }
  </style>
</head>
<body>

  <h1>üî• MarkNet</h1>

  <div id="auth">
    <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
    <input id="reg-email" placeholder="Email"><br>
    <input id="reg-username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"><br>
    <input id="reg-password" type="password" placeholder="–ü–∞—Ä–æ–ª—å"><br>
    <button id="register-btn">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>

    <h2>–í—Ö–æ–¥</h2>
    <input id="login-email" placeholder="Email"><br>
    <input id="login-password" type="password" placeholder="–ü–∞—Ä–æ–ª—å"><br>
    <button id="login-btn">–í–æ–π—Ç–∏</button>
  </div>

  <div id="app" class="hidden">
    <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, <span id="user-name"></span>!</h2>
    <button onclick="logout()">–í—ã–π—Ç–∏</button>

    <h3>–°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
    <div id="user-list" class="user-list"></div>

    <h3>–ß–∞—Ç</h3>
    <div class="chat" id="chat-box"></div>
    <input id="chat-input" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ...">
    <button onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>

    <h3><a href="#" onclick="openDev()">–í–∫–ª–∞–¥–∫–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤</a></h3>
    <div id="dev-section" class="hidden">
      <p>üë®‚Äçüíª –ü—Ä–∏–≤–µ—Ç, —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫! –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç —Ç—É—Ç.</p>
    </div>
  </div>

  <script>
    let users = JSON.parse(localStorage.getItem("users") || "[]");
    let messages = JSON.parse(localStorage.getItem("messages") || "[]");
    let currentUser = null;

    function saveData() {
      localStorage.setItem("users", JSON.stringify(users));
      localStorage.setItem("messages", JSON.stringify(messages));
    }

    document.getElementById("register-btn").onclick = () => {
      const email = document.getElementById("reg-email").value.trim();
      const username = document.getElementById("reg-username").value.trim();
      const password = document.getElementById("reg-password").value;
      if (!email || !username || !password) {
        alert("–ó–∞–ø–æ–ª–Ω–∏ –≤—Å–µ –ø–æ–ª—è!");
        return;
      }
      if (users.some(u => u.email === email)) {
        alert("–¢–∞–∫–æ–π email —É–∂–µ –µ—Å—Ç—å!");
        return;
      }
      const avatar = `https://api.dicebear.com/7.x/personas/svg?seed=${username}`;
      users.push({ email, username, password, avatar });
      saveData();
      alert("–£—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!");
    };

    document.getElementById("login-btn").onclick = () => {
      const email = document.getElementById("login-email").value.trim();
      const password = document.getElementById("login-password").value;
      const user = users.find(u => u.email === email && u.password === password);
      if (!user) {
        alert("–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å");
        return;
      }
      currentUser = user;
      showApp();
    };

    function logout() {
      currentUser = null;
      document.getElementById("auth").classList.remove("hidden");
      document.getElementById("app").classList.add("hidden");
    }

    function showApp() {
      document.getElementById("auth").classList.add("hidden");
      document.getElementById("app").classList.remove("hidden");
      document.getElementById("user-name").textContent = currentUser.username;
      renderUsers();
      renderMessages();
    }

    function renderUsers() {
      const list = document.getElementById("user-list");
      list.innerHTML = "";
      for (let u of users) {
        const div = document.createElement("div");
        div.innerHTML = `<img src="${u.avatar}">${u.username}`;
        list.appendChild(div);
      }
    }

    function renderMessages() {
      const box = document.getElementById("chat-box");
      box.innerHTML = "";
      for (let msg of messages) {
        const div = document.createElement("div");
        div.textContent = `${msg.user}: ${msg.text}`;
        box.appendChild(div);
      }
      box.scrollTop = box.scrollHeight;
    }

    function sendMessage() {
      const input = document.getElementById("chat-input");
      const text = input.value.trim();
      if (!text) return;
      messages.push({ user: currentUser.username, text });
      input.value = "";
      saveData();
      renderMessages();
    }

    function openDev() {
      const password = prompt("–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å:");
      if (password === "5565") {
        document.getElementById("dev-section").classList.remove("hidden");
      } else {
        alert("–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!");
      }
    }
  </script>

</body>

<div id="chat" class="chat-container">
  <h2>üí¨ –ß–∞—Ç</h2>
  <div id="messages" class="chat-box"></div>
  <input type="text" id="messageInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." />
  <button onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
</div>

</html>
